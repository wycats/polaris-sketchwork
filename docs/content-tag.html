<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Content Tag - Polaris Design Sketches</title>
        <!-- Custom HTML head -->
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="theme/custom.css">
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="proposals.html"><strong aria-hidden="true">1.</strong> Polaris Sketchwork</a></li><li class="chapter-item expanded "><a href="reactivity.html"><strong aria-hidden="true">2.</strong> Polaris Reactivity</a></li><li class="chapter-item expanded "><a href="match.html"><strong aria-hidden="true">3.</strong> #match Control Flow</a></li><li class="chapter-item expanded "><a href="routing.html"><strong aria-hidden="true">4.</strong> Routing</a></li><li class="chapter-item expanded "><a href="content-tag.html" class="active"><strong aria-hidden="true">5.</strong> Content Tag</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="content-tag/simplified-javascript-lexer.html"><strong aria-hidden="true">5.1.</strong> Appendix: Simplified JavaScript Lexer</a></li><li class="chapter-item expanded "><a href="content-tag/second-phase-compiler.html"><strong aria-hidden="true">5.2.</strong> Appendix: Optional Second Phase</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" hidden class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Polaris Design Sketches</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="javascript-with-content-tags"><a class="header" href="#javascript-with-content-tags">JavaScript With Content Tags</a></h1>
<p>ðŸš§ðŸš§ðŸš§ðŸš§ This document is a work in progress. The precise details are still rapidly evolving, and not everything that we already know is written down yet. ðŸš§ðŸš§ðŸš§ðŸš§</p>
<p>JavaScript with Content Tags is an extension to ECMAScript that makes it possible to embed other languages in JavaScript. Importantly, embedded content can refer to variables in the surrounding JavaScript environment.</p>
<p>Like template literals, this proposal is designed for modularity: anyone can define a content tag without needing to change the core design. Unlike template literals, content tags have a <strong>build-time</strong> component, which allows them to translate their specific content tag into JavaScript.</p>
<h2 id="the-syntax"><a class="header" href="#the-syntax">The Syntax</a></h2>
<pre><code class="language-diff">  PrimaryExpression :
+   ContentTag

  Declaration :
+   ContentTag

  FunctionBody :
+   ContentTag

  ClassElement :
+   ContentTag
+
+ ContentTag :
+   &quot;&lt;&quot; ContentTagOpen [TemplateAttributes] &quot;&gt;&quot; ContentTagBody &quot;&lt;/&quot; ContentTagClose &quot;&gt;&quot;
+
+ ContentTagOpen :
+   TagName (* lookahead: whitespace or &quot;&gt;&quot;)
+
+ ContentTagClose :
+   TagName (* must match most recent ContentTagOpen *)
+ 
+ TagName :
+     Identifier
+   | Identifier { &quot;.&quot; Identifier }
+ 
+ ContentTagBody :
+   &lt;unicode character&gt;* (* lookahead: &quot;&lt;/template&gt;&quot; *)
+
+ TemplateAttributes :
+   &lt;whitespace&gt; { TemplateAttribute } &lt;whitespace&gt;
+
+ TemplateAttribute :
+   AttributeName (* lookahead: &lt;whitespace&gt; | &quot;&gt;&quot; *)
+   AttributeName &quot;=&quot; AttributeValue
+
+ AttributeName :
+   { &lt;not whitespace or &quot;=&quot;&gt; }
+
+ AttributeValue :
+     &quot;{&quot; AttributeExpression &quot;}&quot;
+   | SingleQuotedAttributeValue
+   | DoubleQuotedAttributeValue
+
+ AttributeExpression :
+   &lt;described below&gt;
+
+ SingleQuotedAttributeValue :
+   &quot;'&quot; { &lt;not &quot;'&quot;&gt; } &quot;'&quot;
+ 
+ DoubleQuotedAttributeValue :
+   '&quot;' { &lt;not '&quot;'&gt; } '&quot;'
</code></pre>
<h3 id="attributeexpression"><a class="header" href="#attributeexpression">AttributeExpression</a></h3>
<p>AttributeExpression is lexed using the <a href="content-tag/simplified-javascript-lexer.html">simplified JavaScript lexer</a>.</p>
<h2 id="translation"><a class="header" href="#translation">Translation</a></h2>
<h3 id="primaryexpression"><a class="header" href="#primaryexpression">PrimaryExpression</a></h3>
<p>The content tag name is translated to the tag reference of a tagged template literal. The body of the tag is translated to the body of the tagged template literal.</p>
<p>If the content tag contains attributes, the attributes are translated to an object literal. Attributes with values are translated to keys and values in the object literal. Attributes without values are translated the same way, with the value <code>true</code>. The object literal is passed to the tagged template literal.</p>
<h4 id="basic-example"><a class="header" href="#basic-example">Basic Example</a></h4>
<pre><code class="language-jsx">function Card({ person }) {
  return &lt;jsx&gt;
    &lt;div className=&quot;card&quot;&gt;
      &lt;div className=&quot;card-header&quot;&gt;
        &lt;h3&gt;{person.name}&lt;/h3&gt;
      &lt;/div&gt;
      &lt;div className=&quot;card-body&quot;&gt;
        &lt;p&gt;{person.bio}&lt;/p&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/jsx&gt;
}
</code></pre>
<p>This would be translated to:</p>
<pre><code class="language-js">function Card({ person }) {
  return jsx`
    &lt;div className=&quot;card&quot;&gt;
      &lt;div className=&quot;card-header&quot;&gt;
        &lt;h3&gt;${person.name}&lt;/h3&gt;
      &lt;/div&gt;
      &lt;div className=&quot;card-body&quot;&gt;
        &lt;p&gt;${person.bio}&lt;/p&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  `;
}
</code></pre>
<h4 id="example-with-attributes"><a class="header" href="#example-with-attributes">Example With Attributes</a></h4>
<pre><code class="language-gts">const card = &lt;template strict&gt;
  &lt;div class=&quot;card&quot;&gt;
    &lt;div className=&quot;card-header&quot;&gt;
      &lt;h3&gt;{{@person.name}}&lt;/h3&gt;
    &lt;/div&gt;
    &lt;div class=&quot;card-body&quot;&gt;
      &lt;p&gt;{{@person.bio}}&lt;/p&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre>
<p>This would be translated to:</p>
<pre><code class="language-js">const card = template({ strict: true })`
  &lt;div class=&quot;card&quot;&gt;
    &lt;div className=&quot;card-header&quot;&gt;
      &lt;h3&gt;${person.name}&lt;/h3&gt;
    &lt;/div&gt;
    &lt;div class=&quot;card-body&quot;&gt;
      &lt;p&gt;${person.bio}&lt;/p&gt;
    &lt;/div&gt;
  &lt;/div&gt;
`;
</code></pre>
<h2 id="compiler-extension-architecture"><a class="header" href="#compiler-extension-architecture">Compiler Extension Architecture</a></h2>
<h2 id="faq"><a class="header" href="#faq">FAQ</a></h2>
<h3 id="why-not-template-literals"><a class="header" href="#why-not-template-literals">Why Not Template Literals?</a></h3>
<p>JavaScript with Content Tags makes it possible for languages with their own syntax for variable references to use that syntax when referring to JavaScript variables. It also allows embedded languages to use any characters without worrying about escaping them, and allows the embedded language to restrict how JavaScript variables can be used.</p>
<p>In contrast, template literals must use the JavaScript <code>${}</code> syntax, and the embedded content in a template literal is an arbitrary JavaScript expression.</p>
<h4 id="example-embedding-handlebars"><a class="header" href="#example-embedding-handlebars">Example: Embedding Handlebars</a></h4>
<p>For example, consider embedding Handlebars in JavaScript:</p>
<pre><code class="language-gjs">const person = {
  name: &quot;John&quot;,
  location: &quot;New Mexico, USA&quot;,
};

const contact = &lt;template&gt;
  &lt;p&gt;
    &lt;strong&gt;{{person.name}}&lt;/strong&gt; ({{person.location}})
  &lt;/p&gt;
&lt;/template&gt;

contact(); // &lt;p&gt;&lt;strong&gt;John&lt;/strong&gt; (New Mexico, USA)&lt;/p&gt;
</code></pre>
<p>We could parameterize the template using the approach Ember uses today:</p>
<pre><code class="language-gjs">const contact =
  &lt;template&gt;
    &lt;p&gt;
      &lt;strong&gt;{{@name}}&lt;/strong&gt; ({{@location}})
    &lt;/p&gt;
  &lt;/template&gt;

contact({ name: &quot;John&quot;, location: &quot;New Mexico, USA&quot; });
// &lt;p&gt;&lt;strong&gt;John&lt;/strong&gt; (New Mexico, USA)&lt;/p&gt;
</code></pre>
<p>Or by creating a function that takes the person as a parameter:</p>
<pre><code class="language-gjs">function Contact(person) {
  &lt;template&gt;
    &lt;p&gt;
      &lt;strong&gt;{{person.name}}&lt;/strong&gt; ({{person.location}})
    &lt;/p&gt;
  &lt;/template&gt;
}

contact({ name: &quot;John&quot;, location: &quot;New Mexico, USA&quot; });
// &lt;p&gt;&lt;strong&gt;John&lt;/strong&gt; (New Mexico, USA)&lt;/p&gt;
</code></pre>
<p>We could also adopt something like the Ember approach to components:</p>
<pre><code class="language-gts">function Contact(args: { name: string; location: string }) {
  &lt;template&gt;
    &lt;p&gt;
      &lt;strong&gt;{{args.name}}&lt;/strong&gt; ({{args.location}})
    &lt;/p&gt;
  &lt;/template&gt;
}

const Person =
  &lt;template&gt;
    &lt;Contact @name=&quot;John&quot; @location=&quot;New Mexico, USA&quot; /&gt;
  &lt;/template&gt;
</code></pre>
<h4 id="example-embedding-jsx"><a class="header" href="#example-embedding-jsx">Example: Embedding JSX</a></h4>
<p>The content tags framework makes it possible to embed JSX into JavaScript without having to use the <code>${}</code> syntax.</p>
<p>Consider this example from the <a href="https://facebook.github.io/jsx/#sec-why-not-template-literals">JSX</a> proposal, using template literals:</p>
<pre><code class="language-js">// Template Literals
var box = jsx`
  &lt;${Box}&gt;
    ${
      shouldShowAnswer(user) ?
      jsx`&lt;${Answer} value=${false}&gt;no&lt;/${Answer}&gt;` :
      jsx`
        &lt;${Box.Comment}&gt;
         Text Content
        &lt;/${Box.Comment}&gt;
      `
    }
  &lt;/${Box}&gt;
`;
</code></pre>
<p>This obviously reads very poorly. The JSX spec also rightly points out that simply wrapping the JSX in a template literal is not sufficient.</p>
<pre><code class="language-js">var box = jsx`
  &lt;Box&gt;
    {
      shouldShowAnswer(user) ?
      &lt;Answer value={false}&gt;no&lt;/Answer&gt; :
      &lt;Box.Comment&gt;
         Text Content
      &lt;/Box.Comment&gt;
    }
  &lt;/Box&gt;
`;
</code></pre>
<blockquote>
<p>However, this would lead to further divergence. Tooling that is built around the assumptions imposed by template literals wouldn't work. It would undermine the meaning of template literals. It would be necessary to define how JSX behaves within the rest of the ECMAScript grammar within the template literal anyway.</p>
</blockquote>
<p>To address the issue, JSX defines some additional ways to access local variables.</p>
<pre><code class="language-jsx">var box =
  &lt;Box&gt;
    {
      shouldShowAnswer(user) ?
      &lt;Answer value={false}&gt;no&lt;/Answer&gt; :
      &lt;Box.Comment&gt;
         Text Content
      &lt;/Box.Comment&gt;
    }
  &lt;/Box&gt;;
</code></pre>
<p>Since the content tags framework allows embedded languages to specify how their content should access local variables, you could embed JSX in JavaScript:</p>
<pre><code class="language-gjs">var box =
  &lt;jsx&gt;
    &lt;Box&gt;
      {
        shouldShowAnswer(user) ?
        &lt;Answer value={false}&gt;no&lt;/Answer&gt; :
        &lt;Box.Comment&gt;
          Text Content
        &lt;/Box.Comment&gt;
      }
    &lt;/Box&gt;
  &lt;/jsx&gt;
</code></pre>
<h4 id="example-embedding-css"><a class="header" href="#example-embedding-css">Example: Embedding CSS</a></h4>
<p>The general content tags framework allows us to easily embed other languages in JavaScript, and allow those languages to refer to JavaScript variables. Let's define a tiny extension to CSS that allows us to refer to JavaScript variables:</p>
<pre><code class="language-gjs">const color = &quot;red&quot;;

&lt;style&gt;
  .red {
    color: $color;
  }
&lt;/style&gt;
</code></pre>
<p>In this case, we allow <code>$</code>-prefixed names to refer to JavaScript variables.</p>
<blockquote>
<p>We will also allow paths (starting with an identifier followed by any number of <code>.</code> members) to be used as variables, and we will allow standalone functions to be used as CSS functions.</p>
</blockquote>
<p>We could combine a feature like this with the Handlebars example above to make it possible to create static HTML and CSS files inside JavaScript:</p>
<pre><code class="language-gts">const light = &quot;#fff&quot;;
const dark = &quot;#000&quot;;

function border(color: HexColor): string {
  return `1px solid ${color}`;
}

const styles =
  &lt;style&gt;
    .box {
      border: border($light);
    }
  &lt;/style&gt;

&lt;template&gt;
  &lt;styles /&gt;

  &lt;div class=&quot;box&quot;&gt;
    Hello, World!
  &lt;/div&gt;
&lt;/template&gt;
</code></pre>
<h4 id="conclusion"><a class="header" href="#conclusion">Conclusion</a></h4>
<p>In general, these examples are meant to illustrate the way that content tags can take advantage of JavaScript's lexical scope in ways that are idiomatic to their embedded languages.</p>
<p>ðŸš§ðŸš§ðŸš§ðŸš§ This section is a work in progress. ðŸš§ðŸš§ðŸš§ðŸš§</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="routing.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="content-tag/simplified-javascript-lexer.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="routing.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="content-tag/simplified-javascript-lexer.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script type="module" src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script type="module" src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>